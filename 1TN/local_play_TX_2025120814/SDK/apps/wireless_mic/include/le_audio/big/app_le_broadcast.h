/*********************************************************************************************
    *   Filename        : app_broadcast.h

    *   Description     :

    *   Author          : Weixin Liang

    *   Email           : liangweixin@zh-jieli.com

    *   Last modifiled  : 2022-12-15 14:24

    *   Copyright:(c)JIELI  2011-2022  @ , All Rights Reserved.
*********************************************************************************************/
#ifndef _APP_LE_BROADCASE_H
#define _APP_LE_BROADCASE_H

/*  Include header */
#include "typedef.h"
#include "wireless_trans.h"

#ifdef __cplusplus
extern "C" {
#endif

/**************************************************************************************************
  Data Types
**************************************************************************************************/
enum {
    BROADCAST_SYNC_VOL,
};

enum {
    APP_BROADCAST_STATUS_STOP,
    APP_BROADCAST_STATUS_START,
    APP_BROADCAST_STATUS_SUSPEND,
};

struct __pair_polling_info {
    u16 pair_polling_timer;
    u8 cur_pair_mode;
    u8 connect_succ_flag;
    u8 pair_succ_flag;
};
/**************************************************************************************************
  Function Declarations
**************************************************************************************************/

/* --------------------------------------------------------------------------*/
/**
 * @brief 获取接收方连接状态
 *
 * @return 接收方连接状态
 */
/* ----------------------------------------------------------------------------*/
u8 get_receiver_connected_status(void);

/* --------------------------------------------------------------------------*/
/**
 * @brief 开启广播
 *
 * @return >=0:success
 */
/* ----------------------------------------------------------------------------*/
int app_broadcast_open();

/* --------------------------------------------------------------------------*/
/**
 * @brief 关闭广播
 *
 * @param status:挂起还是停止
 *
 * @return >=0:success
 */
/* ----------------------------------------------------------------------------*/
int app_broadcast_close(u8 status);

/* --------------------------------------------------------------------------*/
/**
 * @brief 广播开关切换
 *
 * @return -1:切换失败，1:关闭成功，2：开启成功
 */
/* ----------------------------------------------------------------------------*/
int app_broadcast_switch(void);


/* --------------------------------------------------------------------------*/
/**
 * @brief 用于外部重新打开发送端的数据流
 */
/* ----------------------------------------------------------------------------*/
void app_broadcast_reset_transmitter(void);

/* --------------------------------------------------------------------------*/
/**
 * @brief 用于外部打开发送端的数据流
 */
/* ----------------------------------------------------------------------------*/
bool app_broadcast_open_transmitter(void);

/* --------------------------------------------------------------------------*/
/**
 * @brief 用于外部关闭发送端的数据流
 */
/* ----------------------------------------------------------------------------*/
void app_broadcast_close_transmitter(void);

/* --------------------------------------------------------------------------*/
/**
 * @brief 更新广播同步状态的数据
 *
 * @param type:更新项
 * @param value:更新值
 *
 * @return 0:success
 */
/* ----------------------------------------------------------------------------*/
int update_broadcast_sync_data(u8 type, int value);

/* --------------------------------------------------------------------------*/
/**
 * @brief 广播资源初始化
 */
/* ----------------------------------------------------------------------------*/
void app_broadcast_init(void);

/* --------------------------------------------------------------------------*/
/**
 * @brief 广播资源卸载
 */
/* ----------------------------------------------------------------------------*/
void app_broadcast_uninit(void);

/* --------------------------------------------------------------------------*/
/**
 * @brief 广播进入配对模式
 *
 * @param role：广播角色接收端还是发送端
 * @param mode：0-广播配对，1-连接配对
 */
/* ----------------------------------------------------------------------------*/
void app_broadcast_enter_pair(u8 role, u8 mode);

/* --------------------------------------------------------------------------*/
/**
 * @brief 退出广播配对模式
 *
 * @param role：广播角色接收端还是发送端
 */
/* ----------------------------------------------------------------------------*/
void app_broadcast_exit_pair(u8 role);

/* --------------------------------------------------------------------------*/
/**
 * @brief 清楚配对信息
 */
/* ----------------------------------------------------------------------------*/
void app_broadcast_remove_pair(void);

/* --------------------------------------------------------------------------*/
/**
 * @brief 非蓝牙后台情况下，在其他音源模式开启BIG，前提要先开蓝牙协议栈
 */
/* ----------------------------------------------------------------------------*/
void app_broadcast_open_in_other_mode();

/* --------------------------------------------------------------------------*/
/**
 * @brief 非蓝牙后台情况下，在其他音源模式关闭BIG
 */
/* ----------------------------------------------------------------------------*/
void app_broadcast_close_in_other_mode();


/* --------------------------------------------------------------------------*/
/**
 * @brief 自定义数据发送接口
 *
 * @param device:发送给远端设备的标识
 * @param data:需要发送的数据
 * @param length:数据长度
 *
 * @return slen:实际发送数据的总长度
 */
/* ----------------------------------------------------------------------------*/
int app_broadcast_send_custom_data(u8 device, void *data, size_t length);

/* --------------------------------------------------------------------------*/
/**
 * @brief 获取bis连接数量
 *
 * @return bis连接数量
 */
/* ----------------------------------------------------------------------------*/
u8 get_bis_connected_num(void);

#ifdef __cplusplus
};
#endif

#endif


