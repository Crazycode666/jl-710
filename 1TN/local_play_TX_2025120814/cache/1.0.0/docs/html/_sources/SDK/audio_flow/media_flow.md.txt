# 媒体

## 单声道
`单声道`需要将DAC配置为单左声道（DAC_OUTPUT_MONO_L），JL703N系列的DAC单声道输出目前仅支持左声道。
- **单声道**<br>
![MONO_L](./assets/MONO_L.png)
- **单声道pro**<br>
![MONO_L_pro](./assets/MONO_L_pro.png)
## 立体声
`立体声`需要将DAC配置为双声道（DAC_OUTPUT_LR）
- **立体声**<br>
提供一个`EQ`，一个`DRC`作基础的音效调节。
![LR](./assets/LR.png)
- **立体声pro**<br>
添加`vbass`虚拟低音，对于某些低频缺失的喇叭/腔体，能够显著地提升低频表现力。将drc更换为`多带drc`，数据经过分频器的分频，可对数据的不同频段做不同的处理，实现低、中、高音分别对应不同的drc，并且在三路drc处理的数据合并后再经过一个全带drc，调试时具有更高的灵活性以及更好的效果，但相应的资源消耗也会更大。
![LR_pro](./assets/LR_pro.png)

## 1.1声道
`1.1声道`需要将DAC配置为双声道（DAC_OUTPUT_LR），左声道（L）作为全频喇叭，右声道（R）作为低音喇叭。
- **1.1_channel**<br>
![1.1_channel](./assets/1.1_channel.png)

## 2.1声道
`2.1声道`需要将DAC配置为四声道（FRONT_LR_REAR_LR），FL/FR组成LR通路（全频音箱），RL/RR组成SW通路（低音音箱）。<br>
`蓝牙音乐`、`LINEIN模式`、`本地音乐`、`FM模式`、`SPDIF模式`均内置了2.1声道流程。可通过场景切换功能切换不同音乐风格。<br>
流程中串入三个`音量控制器`，分别控制总音量，LR通路音量，SW通路音量；可通过`EQ`、`DRC`、`StereoMix`等模块调试音效。<br>
- **2.1_channel**<br>
![2.1_channel](./assets/2.1_channel.png)
- **2.1_channel_pro**<br>
添加`高低音`（可通过旋钮调节高/中/低频段增益）、`环绕声`模块，将drc更换为`多带drc`。
![2.1_channel_pro](./assets/2.1_channel_pro.png)

## 空间音效预设
|版本|CPU(Hz)|RAM(byte)|Code(byte)|备注|
|---|---|---|---|---|
|空间音效|11M|8k|42k|支持头部跟踪，算力统计条件：固定模式|
|空间音效3.0.0|57M|33k|114k|支持头部跟踪，算力统计条件：固定模式<br>*3.0.0版本空间感更好，资源消耗更多*|
|空间音效lite<br>(空间音频1)|10M|8k|23k|不支持头部跟踪<br>*轻量级版本，资源消耗更低，空间感相对偏弱一点*<br>曾用名：空间音频1|
### 空间音效
- 空间音效v2.0.0版本，资源消耗（44.1k、32bit、代码放flash，Code:42K）：
    - Mips:11 MHz，Ram:8k Bytes。
- 使用该框图需要在`音频配置-空间音效配置-音效算法版本选择`配置V2.0.0版本。
- 支持配置传感器以使用跟踪模式。
![v200](./assets/spatial_effect_0.png)
- 支持两种模式切换方式：
    - 无缝切换：开关数据流时，插入/跳过空间音效处理，可以做到平滑过渡。
    - 提示音打断切换：切换时播放打断提示音，会根据当前模式选择对应的数据流，数据流需要重开。
    ```c
    /*
     * spatial_effects_process.h
     * 模式切换是否添加打断提示音，数据流重新开关
     */
    #define SPATIAL_AUDIO_EFFECT_SW_TONE_PLAY     0
    ```
![v200](./assets/spatial_effect_3.png)
### 空间音效3.0.0
- 空间音效v3.0.0版本，资源消耗（44.1k、32bit、代码放flash，Code:114K）：
    - Mips:57 MHz，Ram:33k Bytes。
- 使用该框图需要在`音频配置-空间音效配置-音效算法版本选择`配置V3.0.0版本。
- 与v2.0.0版本相同，支持配置传感器以使用跟踪模式。
- 与v2.0.0版本相同，支持两种模式切换方式
![v300](./assets/spatial_effect_1.png)
![v300](./assets/spatial_effect_2.png)
### 空间音效lite
- 空间音效轻量级版本，资源消耗（44.1k、代码放flash，Code:23K）：
    - 16in32out（tws对耳配对状态）：Mips:10 MHz，Ram:8k Bytes。
    - 16in32out（头戴式耳机或tws非配对状态）：Mips:18 MHz，Ram:8k Bytes。
    - 32in32out（tws对耳配对状态）：Mips:9 MHz，Ram:8k Bytes。
    - 32in32out（头戴式耳机或tws非配对状态）：Mips:15 MHz，Ram:8k Bytes。
- 不需要在音频配置中配置版本，不支持传感器跟踪模式
![lite](./assets/spatial_effect_4.png)

## TWS输出双驱动单元使能
### 使用场景
可使用DAC的左右声道分开推耳机的不同驱动单元
### 配置环境
- 使能TWS
- DAC配置为立体声
- 可视化界面使用"TWS耳机"框图
- 代码使能：
```c
//audio_general_config.h
#define AUDIO_TWS_DUAL_DRIVER_ENABLE   1
```
- 可通过"声道拆分"分别对两通道数据进行处理，以实现不同驱动单元的需求，如图所示：
![](./assets/tws_dual_driver.png)
### 输出现象
- 对耳使用：
    - 一台输出"L L"数据(DAC通道0/通道1，均输出左声道数据)
    - 另一台输出"R R"数据(DAC通道0/通道1，均输出右声道数据)
- 单耳使用：
    - 输出"LRMIX LRMIX"数据(DAC通道0/通道1，均输出左右声道混合数据)

