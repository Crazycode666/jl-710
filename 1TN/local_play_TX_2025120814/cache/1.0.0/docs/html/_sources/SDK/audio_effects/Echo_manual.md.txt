# 回声（Echo）

## 功能介绍
* 通过重复播放衰减的输入，产生回声的效果

## 参数简述
* **Delay Time**: 回声反射间隔，配置越大所需buffer越多，粗略计算公式：`RAM = 3200 * sr / 16000 * auido_echo_delay_ms / 100`。
* **Decay Factor**: 回声衰减系数，值越大，衰减越慢，回声持续实际越长。
* **Filt Enable**: 回声是否低通
* **LPF Cutoff**: 回声低通截止频率，频率越低，回声部分高频成分越少，回声整体能量也相应减小。
* **Wet Gain**: 湿声增益
* **Dry Gain**: 干声增益
* **Wet Bit Width**：使用24bit数据流时，echo湿声精度配置，可配置为16bit节省资源。

## FAQ

Q：**echo尾音持续很久？**<br>
A：首先区分样机是否带有模拟反馈成分？ 可以戴上耳机，关闭喇叭输出。听下尾音长度，如果依旧太长，可以减小`Decay Factor` 或者修改 `Lpf Cutoff`。 这2者的修改是有区别的，`Decay Factor`是调整了尾音的整体衰减速度， 而`Lpf Cutoff`是减弱了尾音中的高频成分，从而减弱了尾音，听感上也是会有差异的。
如果模拟增益占比也不小，可以通过调整输出输入增益，或者样机结构等，从而调整模拟反馈。

Q：**echo希望调出尾音比较润色悠长，但是又不要太影响原声的清晰度？**<br>
A：可以将Echo中的Dry Gain设成0。然后对Echo这路EQ做高通，削弱低频，整体起装饰作用。 接着 调整bypass通路的EQ。可以适当加强中低频。 

Q：**delay(回声延时)** 当Delay Time配置超过auido_echo_delay_ms时，会将audio_echo_delay_ms的值更新为Delay Time的值并重新申请buffer。
```
变量在log_config/lib_media_config.c文件内
const int auido_echo_delay_ms  = 200;//回声最大延时(单位ms),值越大buf就越大
```
