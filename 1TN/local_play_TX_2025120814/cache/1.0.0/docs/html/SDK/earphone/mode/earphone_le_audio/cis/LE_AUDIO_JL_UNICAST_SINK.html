

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LE_AUDIO_JL_UNICAST_SINK开发说明 &mdash; JL Project Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="https://doc.zh-jieli.com/static/css/custom.css" />

  
      <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../../_static/documentation_options.js?v=fa47ad08"></script>
      <script src="../../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="https://doc.zh-jieli.com/static/js/custom.js"></script>
      <script src="../../../../../_static/js/custom.js?v=bfa33168"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html">
            
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">SDK入门</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../framework/index.html">1. 技术框架</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/index.html">2. 快速入门</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">主要功能介绍</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../wireless_mic/index.html">1. SDK 详细介绍</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">系统功能进阶</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../driver/index.html">1. 外设驱动</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../driver/pmu/index.html">2. 电源管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../key_config/index.html">3. 按键配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pwm_led/index.html">4. LED状态显示</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../system/file_system/index.html">5. 文件系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../system/os/index.html">6. 操作系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev_manager/index.html">7. 设备管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../system/%E9%80%9A%E7%94%A8%E7%BB%84%E4%BB%B6/index.html">8. 通用组件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../system/report/index.html">9. 系统状态报告</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../system/resource_manage/index.html">10. 资源管理帮助</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">蓝牙功能进阶</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../bt/btstack/index.html">1. 蓝牙协议栈</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bt/ble/index.html">2. BLE开发指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bt/FindMy/FindMy.html">3. FindMy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">音频功能进阶</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../audio/index.html">1. 音频播放</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../audio_config/index.html">2. 音频配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../audio_flow/index.html">3. 音频流程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../audio_effects/index.html">4. 音效调试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../audio_FAQ/index.html">5. 音频FAQ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">JieLi_蓝牙音频</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">LE_AUDIO_JL_UNICAST_SINK开发说明</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Authors</p></td>
<td><p>Date</p></td>
<td><p>Brief</p></td>
</tr>
<tr class="row-even"><td><p>JL系统中心部门</p></td>
<td><p>2024/09/30</p></td>
<td><p>LingXuanfeng、ZhengWeijie、WangChunhui编撰</p></td>
</tr>
</tbody>
</table>
<section id="le-audio-jl-unicast-sink">
<h1>LE_AUDIO_JL_UNICAST_SINK开发说明<a class="headerlink" href="#le-audio-jl-unicast-sink" title="Link to this heading"></a></h1>
<section id="id1">
<h2>开发说明<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>LE_AUDIO_UNICAST是指LE_AUDIO点对点的单一传输，不同于LE_AUDIO_AURACAST点对多的广播传输，SINK是接收端、SOURCE是发送端，另外，下面提到的CIS也是LE_AUDIO_UNICAST。</p></li>
<li><p>LE_AUDIO_UNICAST dongle是指杰理自研的蓝牙转换头，通过USB连接手机或者电脑等设备，使一些不支持LE_AUDIO_UNICAST功能的电脑和手机能够支持LE_AUDIO_UNICAST。</p></li>
</ol>
</section>
<section id="id2">
<h2>功能说明<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<blockquote>
<div><figure class="align-default">
<img alt="../../../../../_images/%E5%BC%80%E5%8F%91%E8%AF%B4%E6%98%8E1.png" src="../../../../../_images/%E5%BC%80%E5%8F%91%E8%AF%B4%E6%98%8E1.png" />
</figure>
<p>耳机开启LE_AUDIO_JL_UNICAST_SINK功能后，可以通过LE_AUDIO_UNICAST连接一个LE_AUDIO_JL_UNICAST dongle，LE_AUDIO_JL_UNICAST dongle通过USB连接手机、电脑等设备。这样耳机就可以和电脑、手机等设备实现LE_AUDIO_UNICAST交互。</p>
<p>耳机通过LE_AUDIO_UNICAST连接手机或电脑等设备后，可以实现蓝牙低延迟传输，通过LC3编解码获得更高的音质，具有更好的体验。</p>
</div></blockquote>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>开了LE_AUDIO_JL_UNICAST_SINK的工程只支持1拖1，就是耳机连接一个“LE_AUDIO_JL_UNICAST dongle”或“经典蓝牙”后，不能再连接其他设备了。</p>
</div>
</section>
<section id="id3">
<h2>工程配置<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<section id="id4">
<h3>耳机工程配置<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<ol class="arabic">
<li><dl>
<dt>打开BLE开关</dt><dd><figure class="align-default">
<img alt="../../../../../_images/%E5%B7%A5%E7%A8%8B%E9%85%8D%E7%BD%AE0.png" src="../../../../../_images/%E5%B7%A5%E7%A8%8B%E9%85%8D%E7%BD%AE0.png" />
</figure>
</dd>
</dl>
</li>
<li><dl>
<dt>LE_AUDIO配置选择LE_AUDIO_JL_UNICAST_SINK_EN</dt><dd><figure class="align-default">
<img alt="../../../../../_images/%E5%B7%A5%E7%A8%8B%E9%85%8D%E7%BD%AE1.png" src="../../../../../_images/%E5%B7%A5%E7%A8%8B%E9%85%8D%E7%BD%AE1.png" />
</figure>
</dd>
</dl>
</li>
<li><dl>
<dt>“蓝牙音乐”或“媒体”导航栏处的音频流程图选择LE_Audio流程图</dt><dd><figure class="align-default">
<img alt="../../../../../_images/leaudio%E9%9F%B3%E9%A2%91%E6%B5%81%E7%A8%8B%E5%9B%BE1.png" src="../../../../../_images/leaudio%E9%9F%B3%E9%A2%91%E6%B5%81%E7%A8%8B%E5%9B%BE1.png" />
</figure>
</dd>
</dl>
</li>
<li><dl>
<dt>“蓝牙通话”导航栏处的音频流程图选择LE_Audio流程图</dt><dd><figure class="align-default">
<img alt="../../../../../_images/leaudio%E9%9F%B3%E9%A2%91%E6%B5%81%E7%A8%8B%E5%9B%BE2.png" src="../../../../../_images/leaudio%E9%9F%B3%E9%A2%91%E6%B5%81%E7%A8%8B%E5%9B%BE2.png" />
</figure>
</dd>
</dl>
</li>
<li><dl>
<dt>耳机项目的蓝牙名需要同Dongle可视化工程的蓝牙配置-&gt;经典蓝牙-&gt;蓝牙名、LE_AUDIO配置-&gt;UNICAST配置-&gt;配对名一致。</dt><dd><figure class="align-default">
<img alt="../../../../../_images/%E5%B7%A5%E7%A8%8B%E9%85%8D%E7%BD%AE2.png" src="../../../../../_images/%E5%B7%A5%E7%A8%8B%E9%85%8D%E7%BD%AE2.png" />
</figure>
</dd>
</dl>
</li>
<li><dl>
<dt>全局采样率选择48000Hz</dt><dd><figure class="align-default">
<img alt="../../../../../_images/%E5%B7%A5%E7%A8%8B%E9%85%8D%E7%BD%AE3.png" src="../../../../../_images/%E5%B7%A5%E7%A8%8B%E9%85%8D%E7%BD%AE3.png" />
</figure>
</dd>
</dl>
</li>
<li><dl>
<dt>头戴式耳机选择双声道，TWS耳机选择单声道</dt><dd><figure class="align-default">
<img alt="../../../../../_images/%E5%B7%A5%E7%A8%8B%E9%85%8D%E7%BD%AE5.png" src="../../../../../_images/%E5%B7%A5%E7%A8%8B%E9%85%8D%E7%BD%AE5.png" />
</figure>
</dd>
</dl>
</li>
<li><dl>
<dt>“LE_Audio”导航栏处的音频流程图使能，并导出配置</dt><dd><figure class="align-default">
<img alt="../../../../../_images/leaudio%E9%9F%B3%E9%A2%91%E6%B5%81%E7%A8%8B%E5%9B%BE3.png" src="../../../../../_images/leaudio%E9%9F%B3%E9%A2%91%E6%B5%81%E7%A8%8B%E5%9B%BE3.png" />
</figure>
</dd>
</dl>
</li>
</ol>
</section>
<section id="dongle">
<h3>Dongle工程配置<a class="headerlink" href="#dongle" title="Link to this heading"></a></h3>
<ol class="arabic">
<li><dl>
<dt>Dongle项目创建(创建可视化工程-&gt;dongle-&gt;Dongle_3in1)：</dt><dd><figure class="align-default">
<img alt="../../../../../_images/dongle_project.png" src="../../../../../_images/dongle_project.png" />
</figure>
</dd>
</dl>
</li>
<li><dl>
<dt>Dongle项目的蓝牙配置-&gt;经典蓝牙-&gt;蓝牙名：</dt><dd><figure class="align-default">
<img alt="../../../../../_images/dongle%E9%85%8D%E7%BD%AE%E8%93%9D%E7%89%99%E5%90%8D1.png" src="../../../../../_images/dongle%E9%85%8D%E7%BD%AE%E8%93%9D%E7%89%99%E5%90%8D1.png" />
</figure>
</dd>
</dl>
</li>
<li><dl>
<dt>Dongle项目的LE_AUDIO配置-&gt;UNICAST配置-&gt;配对名：</dt><dd><figure class="align-default">
<img alt="../../../../../_images/dongle%E9%85%8D%E7%BD%AE%E8%93%9D%E7%89%99%E5%90%8D2.png" src="../../../../../_images/dongle%E9%85%8D%E7%BD%AE%E8%93%9D%E7%89%99%E5%90%8D2.png" />
</figure>
</dd>
</dl>
</li>
<li><dl>
<dt>Dongle项目的TWS双链接的LE_AUDIO配置：</dt><dd><figure class="align-default">
<img alt="../../../../../_images/dongle%E9%85%8D%E7%BD%AETWS%E5%8F%8C%E9%93%BE%E6%8E%A5.png" src="../../../../../_images/dongle%E9%85%8D%E7%BD%AETWS%E5%8F%8C%E9%93%BE%E6%8E%A5.png" />
</figure>
</dd>
</dl>
</li>
<li><dl>
<dt>Dongle项目TWS双链接，“unicast”导航栏处的音频流程图选择unicast_double_conn流程图：</dt><dd><figure class="align-default">
<img alt="../../../../../_images/dongle%E5%8F%8C%E9%93%BE%E6%8E%A5%E9%9F%B3%E9%A2%91%E6%B5%81%E7%A8%8B%E9%85%8D%E7%BD%AE.png" src="../../../../../_images/dongle%E5%8F%8C%E9%93%BE%E6%8E%A5%E9%9F%B3%E9%A2%91%E6%B5%81%E7%A8%8B%E9%85%8D%E7%BD%AE.png" />
</figure>
</dd>
</dl>
</li>
</ol>
</section>
</section>
<section id="id5">
<h2>流程说明<a class="headerlink" href="#id5" title="Link to this heading"></a></h2>
<blockquote>
<div><figure class="align-default">
<img alt="../../../../../_images/%E6%B5%81%E7%A8%8B%E8%AF%B4%E6%98%8E1.png" src="../../../../../_images/%E6%B5%81%E7%A8%8B%E8%AF%B4%E6%98%8E1.png" />
</figure>
</div></blockquote>
</section>
<section id="id6">
<h2>参数规格<a class="headerlink" href="#id6" title="Link to this heading"></a></h2>
<p>LE_AUDIO_JL_UNICAST资源统计如下：</p>
<p>Bluetooth: 支持蓝牙cis+ACL 双工传输</p>
<p>代码量：249kb</p>
<p>Codec: LC3编码器（RAM13.3K）， LC3解码器（RAM13.1K），播歌（48k）；通话：上行（48k） 、下行（48k）；码率：主机128kbps（发射器） 从机40kbps（耳机）</p>
<p>MIPS：LC3解码：20MHz（64kbps）、40MHz（80kbps），LC3编码：40-50MHz</p>
<p>Algorithm: 音频同步，变采样</p>
</section>
<section id="id7">
<h2>接口说明<a class="headerlink" href="#id7" title="Link to this heading"></a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @brief le_audio功能总初始化</span>
<span class="cm">*/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">le_audio_profile_init</span><span class="p">()</span>

<span class="cm">/**</span>
<span class="cm">* @brief 蓝牙线程消息按需处理，包括连接、断开、超时等事件处理</span>
<span class="cm">*/</span>
<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">le_audio_conn_btstack_event_handler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">_event</span><span class="p">)</span>

<span class="cm">/**</span>
<span class="cm">* @brief le_audio广播开关</span>
<span class="cm">*</span>
<span class="cm">* @param en:1:开广播   0：关广播</span>
<span class="cm">*/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">le_audio_adv_api_enable</span><span class="p">(</span><span class="n">u8</span><span class="w"> </span><span class="n">en</span><span class="p">)</span>

<span class="cm">/**</span>
<span class="cm">* @brief  le_audio媒体控制接口</span>
<span class="cm">*</span>
<span class="cm">* @param data[0] :CIG_EVENT_OPID_VOLUME_UP音量加、CIG_EVENT_OPID_PLAY开始播放等cmd命令</span>
<span class="cm">*/</span>
<span class="kt">void</span><span class="w"> </span><span class="n">le_audio_media_control_cmd</span><span class="p">(</span><span class="n">u8</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">u8</span><span class="w"> </span><span class="n">len</span><span class="p">)</span>

<span class="cm">/**</span>
<span class="cm">* @brief CIG从机连接成功事件处理，在这个接口里面会打开播歌和通话的编解码器</span>
<span class="cm">*</span>
<span class="cm">* @param priv:连接成功附带的句柄参数</span>
<span class="cm">*</span>
<span class="cm">* @return 是否执行成功 -- 0为成功，其他为失败</span>
<span class="cm">*/</span>
<span class="kt">int</span><span class="w"> </span><span class="n">connected_perip_connect_deal</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">priv</span><span class="p">)</span>

<span class="cm">/**</span>
<span class="cm">* @brief CIG从机连接断开成功处理接口，在这个接口里面会关闭播歌和通话的编解码器</span>
<span class="cm">*</span>
<span class="cm">* @param priv:断连成功附带的句柄参数</span>
<span class="cm">*</span>
<span class="cm">* @return 是否执行成功 -- 0为成功，其他为失败</span>
<span class="cm">*/</span>
<span class="kt">int</span><span class="w"> </span><span class="n">connected_perip_disconnect_deal</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">priv</span><span class="p">)</span>

<span class="w"> </span><span class="cm">/**</span>
<span class="cm">* @brief  CIG状态处理函数，包括接收到CIG_EVENT_PERIP_CONNECT、CIG_EVENT_ACL_CONNECT、CIG_EVENT_JL_DONGLE_CONNECT等事件的处理</span>
<span class="cm">*</span>
<span class="cm">* @param msg:状态事件附带的返回参数</span>
<span class="cm">*</span>
<span class="cm">* @return 是否执行成功 -- 0为成功，其他为失败</span>
<span class="cm">*/</span>
<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">app_connected_conn_status_event_handler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>其余更多接口使用说明，详细见app_le_connected.h/.c和le_connected.h/.c</p>
</div>
</section>
<section id="id8">
<h2>低延时配置<a class="headerlink" href="#id8" title="Link to this heading"></a></h2>
<section id="id9">
<h3>耳机工程低延时配置<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<blockquote>
<div><figure class="align-default">
<img alt="../../../../../_images/%E5%BB%B6%E6%97%B6%E9%85%8D%E7%BD%AE0.png" src="../../../../../_images/%E5%BB%B6%E6%97%B6%E9%85%8D%E7%BD%AE0.png" />
</figure>
</div></blockquote>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>当客户需要实测耳机与dongle的延时时，除了上述耳机工程le_audio延时需要配置，还需要以下代码更改：（如果是作为终端产品生产请保留默认配置即可）</p>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// apps/earphone/log_config/lib_media_config.c文件中，</span>

<span class="c1">// 开发者需要实测耳机与dongle的延时时，请设置config_audio_dac_noisefloor_optimize_enable变量为0.</span>
<span class="c1">// 不然测出来的延时会抖动，是个范围值</span>
<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">config_audio_dac_noisefloor_optimize_enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="c1">// 注意：如果不是延时测试，作为终端产品生产请保留以下的默认配置即可</span>
<span class="c1">//&lt;DAC NoiseGate&gt;</span>
<span class="cp">#if (defined(TCFG_AUDIO_DAC_NOISEGATE_ENABLE) &amp;&amp; TCFG_AUDIO_DAC_NOISEGATE_ENABLE)</span>
<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">config_audio_dac_noisefloor_optimize_enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">BIT</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">config_audio_dac_noisefloor_optimize_enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>杰理实验室测试耳机与dongle的LE_AUDIO_JL_UNICAST连接le_audio延时设置最低是支持2.5ms(默认音频流程图+近距离)，如需要拉距离或音频流程图有更多音效等造成播歌卡顿，请按5-10ms的幅度往上进行校准调试。</p>
</div>
</section>
<section id="id10">
<h3>Dongle工程低延时配置<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<blockquote>
<div><p>Dongle工程低延时配置说明，详细看Dongle的可视化工程帮助文档
- Dongle低延时测试配置说明 <a class="reference download internal" download="" href="../../../../../_downloads/d240af4423ed7b8dadc255e306fd1fda/Dongle%E4%BD%8E%E5%BB%B6%E6%97%B6%E6%B5%8B%E8%AF%95%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.pdf"><code class="xref download docutils literal notranslate"><span class="pre">点击下载</span></code></a></p>
</div></blockquote>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>杰理实验室测试，按照上述低延时配置耳机程序与Dongle程序：Dongle端数据到耳机端输出的总延时约为:16.8ms</p>
</div>
</section>
</section>
<section id="id11">
<h2>问题汇总<a class="headerlink" href="#id11" title="Link to this heading"></a></h2>
<section id="id12">
<h3>运行时钟与低延时的关系关系是怎么样的？<a class="headerlink" href="#id12" title="Link to this heading"></a></h3>
<blockquote>
<div><p>LE_AUDIO_JL_UNICAST播歌通话默认固定使用了芯片的最高时钟，确保低延时配置不会有播歌通话音频流卡顿的问题（耳机无法知道dongle那边配置了低延时配置）。
如果Dongle工程不是使用低延时配置而是采用默认配置，则下述截图代码clock_alloc(“le_audio”, clk_get_max_frequency());可以考虑屏蔽达到降低功耗的需求。</p>
<figure class="align-default">
<img alt="../../../../../_images/le_audio_jl_unicast_clock.png" src="../../../../../_images/le_audio_jl_unicast_clock.png" />
</figure>
</div></blockquote>
</section>
<section id="le-audio-jl-unicast">
<h3>LE_AUDIO_JL_UNICAST播歌卡顿原因：<a class="headerlink" href="#le-audio-jl-unicast" title="Link to this heading"></a></h3>
<p>常见的播歌卡顿打印有：</p>
<ol class="arabic simple">
<li><p>“SE”说明收到空包（一般是发送端发的数据包是空包需要检查发送端的原因，也可能这个现象是正常的）；</p></li>
<li><p>“SL”说明没有收到包（可能被干扰了，可以使用蓝牙分析仪捉包检查一下）；</p></li>
</ol>
</section>
<section id="ll-hci-vendor-send-priv-cmddongle-lea">
<h3>耳机调用ll_hci_vendor_send_priv_cmd发送自定义数据给dongle，出现lea断链：<a class="headerlink" href="#ll-hci-vendor-send-priv-cmddongle-lea" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>最大发送数据长度过长，会出现lea断连或断言的现象:</p></li>
</ol>
<blockquote>
<div><p>将耳机和dongle的aclMaxPduCToP和aclMaxPduPToC都改为 16（改大到同一数值）</p>
<figure class="align-default">
<img alt="../../../../../_images/dongle%E8%80%B3%E6%9C%BA%E6%96%AD%E8%BF%9E1.png" src="../../../../../_images/dongle%E8%80%B3%E6%9C%BA%E6%96%AD%E8%BF%9E1.png" />
</figure>
<p>将耳机和dongle的aclMaxPduPToC和aclMaxPduCToP都改为 36（改大到同一数值）</p>
<figure class="align-default">
<img alt="../../../../../_images/dongle%E8%80%B3%E6%9C%BA%E6%96%AD%E8%BF%9E2.png" src="../../../../../_images/dongle%E8%80%B3%E6%9C%BA%E6%96%AD%E8%BF%9E2.png" />
</figure>
</div></blockquote>
<p>2.改大重发次数</p>
<blockquote>
<div><figure class="align-default">
<img alt="../../../../../_images/dongle%E8%80%B3%E6%9C%BA%E6%96%AD%E8%BF%9E3.png" src="../../../../../_images/dongle%E8%80%B3%E6%9C%BA%E6%96%AD%E8%BF%9E3.png" />
</figure>
</div></blockquote>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>注意：以上几点的修改牺牲了cis的重发拿来发acl数据，会影响到距离。</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2010-2026, 杰理科技股份有限公司.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>